<message message-id="1609953954.1248809609070.JavaMail.jboss@jira01.app.mwc.hst.phx2.redhat.com" list="org.jboss.lists.webbeans-issues" id="24bj5hobs3pu7lje" type="bugs" date="2009-07-28T11:33:18.934912-08:00" year="2009-01-01" year-month="2009-07-01" year-month-day="2009-07-28" thread-id="ft4un4wawjooaxqk"><headers><envelope-from-line>Tue Jul 28 11:33:41 2009</envelope-from-line><from personal="Pete Muir (JIRA)" address="jira-events@lists.jboss.org">"Pete Muir (JIRA)" &lt;jira-events@lists.jboss.org&gt;</from><to personal="webbeans-issues@lists.jboss.org" address="webbeans-issues@lists.jboss.org">webbeans-issues@lists.jboss.org</to><subject normal="[webbeans-issues] [JBoss JIRA] Closed: (WBRI-292) SecurityException during WebBeansBootstrap#boot()">[webbeans-issues] [JBoss JIRA] Closed: (WBRI-292) SecurityException during WebBeansBootstrap#boot()</subject><received>from srv-117d-be06.markmail.marklogic.com ([172.19.8.66])
          by mail-1.a.markmail.int (JAMES SMTP Server 2.3.1) with SMTP ID 150
          for &lt;stuart.whitfield.peck@a.markmail.org&gt;;
          Tue, 28 Jul 2009 11:33:41 -0800 (GMT-08:00)</received><received>from smtp01.dmz-a.mwc.hst.phx2.redhat.com (slb-117n.markmail.marklogic.com [172.19.8.33])
	by mgw-2.public.markmail.int (Postfix) with ESMTP id 8D1EE3B300B4
	for &lt;stuart.whitfield.peck@a.markmail.org&gt;; Tue, 28 Jul 2009 12:33:18 -0700 (PDT)</received><received>from lists01.dmz-a.mwc.hst.phx2.redhat.com (lists01.dmz-a.mwc.hst.phx2.redhat.com [10.5.105.133])
	by smtp01.dmz-a.mwc.hst.phx2.redhat.com (8.13.8/8.13.8) with ESMTP id n6SJXfp0004754;
	Tue, 28 Jul 2009 15:33:41 -0400</received><received>from lists01.dmz-a.mwc.hst.phx2.redhat.com (localhost.localdomain [127.0.0.1])
	by lists01.dmz-a.mwc.hst.phx2.redhat.com (8.13.8/8.13.8) with ESMTP id n6SJXfMA030343;
	Tue, 28 Jul 2009 15:33:41 -0400</received><received>from smtp01.dmz-a.mwc.hst.phx2.redhat.com
	(smtp01.dmz-a.mwc.hst.phx2.redhat.com [10.5.105.134])
	by lists01.dmz-a.mwc.hst.phx2.redhat.com (8.13.8/8.13.8) with ESMTP id
	n6SJXT3M030338
	for &lt;webbeans-issues@lists.jboss.org&gt;; Tue, 28 Jul 2009 15:33:29 -0400</received><received>from jira01.app.mwc.hst.phx2.redhat.com
	(jira01.app.mwc.hst.phx2.redhat.com [10.5.106.7])
	by smtp01.dmz-a.mwc.hst.phx2.redhat.com (8.13.8/8.13.8) with ESMTP id
	n6SJXTki004748
	for &lt;webbeans-issues@lists.jboss.org&gt;; Tue, 28 Jul 2009 15:33:29 -0400</received><received>from jira01.app.mwc.hst.phx2.redhat.com (localhost.localdomain
	[127.0.0.1])
	by jira01.app.mwc.hst.phx2.redhat.com (8.13.8/8.13.8) with ESMTP id
	n6SJXT3N030943
	for &lt;webbeans-issues@lists.jboss.org&gt;; Tue, 28 Jul 2009 15:33:29 -0400</received><message-id>1609953954.1248809609070.JavaMail.jboss@jira01.app.mwc.hst.phx2.redhat.com</message-id><date>Tue, 28 Jul 2009 15:33:29 -0400 (EDT)</date><in-reply-to>&lt;671874072.1247370749306.JavaMail.jboss@jira01.app.mwc.hst.phx2.redhat.com&gt;</in-reply-to><mime-version>1.0</mime-version><precedence>bulk</precedence><x-beenthere>webbeans-issues@lists.jboss.org</x-beenthere><x-mailman-version>2.1.9</x-mailman-version><list-id>webbeans -Issues List &lt;webbeans-issues.lists.jboss.org&gt;</list-id><list-unsubscribe>&lt;https://lists.jboss.org/mailman/listinfo/webbeans-issues&gt;, 
	&lt;mailto:webbeans-issues-request@lists.jboss.org?subject=unsubscribe&gt;</list-unsubscribe><list-archive>&lt;http://lists.jboss.org/pipermail/webbeans-issues&gt;</list-archive><list-post>&lt;mailto:webbeans-issues@lists.jboss.org&gt;</list-post><list-help>&lt;mailto:webbeans-issues-request@lists.jboss.org?subject=help&gt;</list-help><list-subscribe>&lt;https://lists.jboss.org/mailman/listinfo/webbeans-issues&gt;,
	&lt;mailto:webbeans-issues-request@lists.jboss.org?subject=subscribe&gt;</list-subscribe><content-type>text/plain; charset="us-ascii"</content-type><content-transfer-encoding>7bit</content-transfer-encoding><sender>webbeans-issues-bounces@lists.jboss.org</sender><errors-to>webbeans-issues-bounces@lists.jboss.org</errors-to></headers><normalized-references><normalized-message-id>1609953954.1248809609070.JavaMail.jboss@jira01.app.mwc.hst.phx2.redhat.com</normalized-message-id><normalized-in-reply-to>671874072.1247370749306.JavaMail.jboss@jira01.app.mwc.hst.phx2.redhat.com</normalized-in-reply-to></normalized-references><body type="text/plain; charset=&quot;us-ascii&quot;"><para depth="0">
     [<br/><url>https://jira.jboss.org/jira/browse/WBRI-292?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel</url><br/>]

</para><para depth="0">Pete Muir closed WBRI-292.
</para><para depth="0">--------------------------

</para><para depth="0">    Resolution: Done
      Assignee: Pete Muir

</para><para depth="0">Fixed, I actually tidied up the the setAccessible code a bit and consolidated it<br/>in constructors of WB* and Reflections

</para><quote depth="1"><quotepara depth="1">SecurityException during WebBeansBootstrap#boot()
</quotepara><quotepara depth="1">-------------------------------------------------

</quotepara><quotepara depth="1">                Key: WBRI-292
                URL: <url>https://jira.jboss.org/jira/browse/WBRI-292</url>
            Project: Web Beans
         Issue Type: Bug
         Components: Reflection
        Environment: Google App Engine 1.2.1
           Reporter: Takeshi Kondo
           Assignee: Pete Muir
           Priority: Critical
            Fix For: 1.0.0.CR1

</quotepara><quotepara depth="1">        Attachments: security_exception.patch

</quotepara><quotepara depth="1">I've deployed WebBeans to google app engine,  then SecurityException was caused.<br/>In google app engine, don't call Method#setAccessible(boolean) of collection<br/>classes.
WebBeans component caused SecurityException is as follows.
</quotepara><quotepara depth="1">----------------
@RequestScoped
public class RequestScopedMap extends HashMap&lt;String, Object&gt;
{
}
</quotepara><quotepara depth="1">----------------
Failed startup of context<br/>com.google.apphosting.utils.jetty.RuntimeAppEngineWebAppContext@1dae160{/,/base/data/home/apps/lush-life/2.334837686911623456}
java.lang.SecurityException: java.lang.IllegalAccessException: Reflection is not<br/>allowed on protected java.lang.Object java.util.AbstractMap.clone() throws<br/>java.lang.CloneNotSupportedException
	at<br/>com.google.apphosting.runtime.security.shared.intercept.java.lang.reflect.Method_.setAccessible(Method_.java:133)
	at<br/>org.jboss.webbeans.introspector.jlr.WBMethodImpl.&lt;init&gt;(WBMethodImpl.java:94)
	at org.jboss.webbeans.introspector.jlr.WBMethodImpl.of(WBMethodImpl.java:77)
	at org.jboss.webbeans.introspector.jlr.WBClassImpl.&lt;init&gt;(WBClassImpl.java:326)
	at org.jboss.webbeans.introspector.jlr.WBClassImpl.of(WBClassImpl.java:116)
	at<br/>org.jboss.webbeans.resources.ClassTransformer$1.call(ClassTransformer.java:59)
	at<br/>org.jboss.webbeans.resources.ClassTransformer$1.call(ClassTransformer.java:1)
	at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
	at java.util.concurrent.FutureTask.run(Unknown Source)
	at<br/>org.jboss.webbeans.util.collections.ConcurrentCache.putIfAbsent(ConcurrentCache.java:125)
	at<br/>org.jboss.webbeans.resources.ClassTransformer.loadClass(ClassTransformer.java:54)
	at<br/>org.jboss.webbeans.introspector.jlr.AbstractWBType.&lt;init&gt;(AbstractWBType.java:64)
	at org.jboss.webbeans.introspector.jlr.WBClassImpl.&lt;init&gt;(WBClassImpl.java:127)
	at org.jboss.webbeans.introspector.jlr.WBClassImpl.of(WBClassImpl.java:116)
	at<br/>org.jboss.webbeans.resources.ClassTransformer$1.call(ClassTransformer.java:59)
	at<br/>org.jboss.webbeans.resources.ClassTransformer$1.call(ClassTransformer.java:1)
	at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
	at java.util.concurrent.FutureTask.run(Unknown Source)
	at<br/>org.jboss.webbeans.util.collections.ConcurrentCache.putIfAbsent(ConcurrentCache.java:125)
	at<br/>org.jboss.webbeans.resources.ClassTransformer.loadClass(ClassTransformer.java:54)
	at<br/>org.jboss.webbeans.introspector.jlr.AbstractWBType.&lt;init&gt;(AbstractWBType.java:64)
	at org.jboss.webbeans.introspector.jlr.WBClassImpl.&lt;init&gt;(WBClassImpl.java:127)
	at org.jboss.webbeans.introspector.jlr.WBClassImpl.of(WBClassImpl.java:116)
	at<br/>org.jboss.webbeans.resources.ClassTransformer$1.call(ClassTransformer.java:59)
	at<br/>org.jboss.webbeans.resources.ClassTransformer$1.call(ClassTransformer.java:1)
	at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
	at java.util.concurrent.FutureTask.run(Unknown Source)
	at<br/>org.jboss.webbeans.util.collections.ConcurrentCache.putIfAbsent(ConcurrentCache.java:125)
	at<br/>org.jboss.webbeans.resources.ClassTransformer.loadClass(ClassTransformer.java:54)
	at org.jboss.webbeans.bootstrap.BeanDeployer.addClass(BeanDeployer.java:65)
	at org.jboss.webbeans.bootstrap.BeanDeployer.addClasses(BeanDeployer.java:84)
	at<br/>org.jboss.webbeans.bootstrap.WebBeansBootstrap.registerBeans(WebBeansBootstrap.java:234)
	at<br/>org.jboss.webbeans.bootstrap.WebBeansBootstrap.boot(WebBeansBootstrap.java:287)
</quotepara></quote><footer type="noise" depth="0">
</footer><footer type="signature" depth="0" hash="2152092100150435196">-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:<br/><url>https://jira.jboss.org/jira/secure/Administrators.jspa</url>
-
For more information on JIRA, see: <url>http://www.atlassian.com/software/jira</url>

</footer><footer type="list-management" depth="0">_______________________________________________
webbeans-issues mailing list
<email>webbeans-issues@lists.jboss.org</email>
<url>https://lists.jboss.org/mailman/listinfo/webbeans-issues</url>
</footer></body></message>