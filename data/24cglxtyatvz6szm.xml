<message message-id="1259135763.394492.26393.nullmailer@svn.kde.org" list="org.kde.kde-commits" id="24cglxtyatvz6szm" type="checkins" date="2009-11-24T23:55:45.394255-08:00" year="2009-01-01" year-month="2009-11-01" year-month-day="2009-11-24" thread-id="uby6qbckuwzc5nqu"><headers><envelope-from-line>Tue Nov 24 23:56:08 2009</envelope-from-line><from personal="Volker Krause" address="vkrause@kde.org">Volker Krause &lt;vkrause@kde.org&gt;</from><to personal="kde-commits@kde.org" address="kde-commits@kde.org">kde-commits@kde.org</to><subject normal="KDE/kdepimlibs/akonadi">KDE/kdepimlibs/akonadi</subject><received>from srv-117d-be06.markmail.marklogic.com ([172.19.8.66])
          by mail-1.a.markmail.int (JAMES SMTP Server 2.3.1) with SMTP ID 456
          for &lt;juliet.walls.arnold@a.markmail.org&gt;;
          Tue, 24 Nov 2009 23:56:08 -0800 (GMT-08:00)</received><received>from ktown.kde.org (slb-117n.markmail.marklogic.com [172.19.8.33])
	by mgw-2.public.markmail.int (Postfix) with SMTP id 559DC3B300DE
	for &lt;juliet.walls.arnold@a.markmail.org&gt;; Tue, 24 Nov 2009 23:55:44 -0800 (PST)</received><received>(qmail 1635 invoked by uid 72); 25 Nov 2009 07:56:05 -0000</received><received>(qmail 1598 invoked from network); 25 Nov 2009 07:56:03 -0000</received><x-spam-checker-version>SpamAssassin 3.2.5 (2008-06-10) on ktown.kde.org</x-spam-checker-version><received>from unknown (HELO office.kde.org) (195.135.221.67)
	by ktown.kde.org with SMTP; 25 Nov 2009 07:56:03 -0000</received><received>from svn.kde.org (localhost [127.0.0.1])
	by office.kde.org (Postfix) with SMTP id 6E84888
	for &lt;kde-commits@kde.org&gt;; Wed, 25 Nov 2009 08:56:03 +0100 (CET)</received><received>(nullmailer pid 26394 invoked by uid 30);
	Wed, 25 Nov 2009 07:56:03 -0000</received><x-commit-directories>(0) trunk/KDE/kdepimlibs/akonadi</x-commit-directories><mime-version>1.0</mime-version><content-type>text/plain; charset=UTF-8</content-type><date>Wed, 25 Nov 2009 07:56:03 +0000</date><message-id>1259135763.394492.26393.nullmailer@svn.kde.org</message-id><x-beenthere>kde-commits@kde.org</x-beenthere><x-mailman-version>2.1.9</x-mailman-version><precedence>list</precedence><reply-to>kde-commits@kde.org</reply-to><list-id>Notification of KDE commits &lt;kde-commits.kde.org&gt;</list-id><list-unsubscribe>&lt;https://mail.kde.org/mailman/listinfo/kde-commits&gt;,
	&lt;mailto:kde-commits-request@kde.org?subject=unsubscribe&gt;</list-unsubscribe><list-post>&lt;mailto:kde-commits@kde.org&gt;</list-post><list-help>&lt;mailto:kde-commits-request@kde.org?subject=help&gt;</list-help><list-subscribe>&lt;https://mail.kde.org/mailman/listinfo/kde-commits&gt;,
	&lt;mailto:kde-commits-request@kde.org?subject=subscribe&gt;</list-subscribe><content-transfer-encoding>quoted-printable</content-transfer-encoding></headers><normalized-references><normalized-message-id>1259135763.394492.26393.nullmailer@svn.kde.org</normalized-message-id></normalized-references><body type="text/plain; charset=utf-8"><para depth="0">SVN commit 1053966 by vkrause:

</para><para depth="0">Use session id if provided manually, fixes a bunch of resource hangs and
about 50 unit tests.

</para><para depth="0"> M  +5 -5      session.cpp  
 M  +1 -1      session_p.h  

</para><para depth="0">--- trunk/KDE/kdepimlibs/akonadi/session.cpp #1053965:1053966
@@ -239,12 +239,12 @@
 {
 }

</para><para depth="0">-void SessionPrivate::init()
+void SessionPrivate::init( const QByteArray &amp;id )
 {
   parser = new ImapParser();

</para><para depth="0">-  if ( !sessionId.isEmpty() ) {
-    sessionId = sessionId;
+  if ( !id.isEmpty() ) {
+    sessionId = id;
   } else {
     sessionId = QCoreApplication::instance()-&gt;applicationName().toUtf8()
         + '-' + QByteArray::number( qrand() );
@@ -279,14 +279,14 @@
     QObject( parent ),
     d( new SessionPrivate( this ) )
 {
-  d-&gt;init();
+  d-&gt;init( sessionId );
 }

</para><para depth="0"> Session::Session( SessionPrivate *dd, const QByteArray &amp; sessionId, QObject *<br/>parent)
     : QObject( parent ),
     d( dd )
 {
-  d-&gt;init();
+  d-&gt;init( sessionId );
 }

</para><para depth="0"> Session::~Session()
--- trunk/KDE/kdepimlibs/akonadi/session_p.h #1053965:1053966
@@ -48,7 +48,7 @@
       delete mConnectionSettings;
     }

</para><para depth="0">-    virtual void init();
+    virtual void init( const QByteArray &amp;sessionId );

</para><para depth="0">     void startNext();
     void reconnect();
</para></body></message>