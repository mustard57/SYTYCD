<message message-id="114590678.434391269352767767.JavaMail.jira@brutus.apache.org" list="org.apache.incubator.cassandra-commits" id="24bzumbdgxvdzqus" type="bugs" date="2010-03-23T13:59:27Z" year="2010-01-01" year-month="2010-03-01" year-month-day="2010-03-23" thread-id="24bzumbdgxvdzqus"><headers><envelope-from-line>Tue Mar 23 05:59:52 2010</envelope-from-line><from personal="Brandon Williams (JIRA)" address="jira@apache.org">"Brandon Williams (JIRA)" &lt;jira@apache.org&gt;</from><to personal="commits@cassandra.apache.org" address="commits@cassandra.apache.org">commits@cassandra.apache.org</to><subject normal="[jira] Commented: (CASSANDRA-834) Exception during batch_mutate">[jira] Commented: (CASSANDRA-834) Exception during batch_mutate</subject><received>from srv-117c-be06.markmail.marklogic.com ([172.19.8.46])
          by mail-1.a.markmail.int (JAMES SMTP Server 2.3.1) with SMTP ID 678
          for &lt;sharron.gross.barron@a.markmail.org&gt;;
          Tue, 23 Mar 2010 05:59:52 -0800 (GMT-08:00)</received><received>from mail.apache.org (slb-117n.markmail.marklogic.com [172.19.8.33])
	by mgw-1.public.markmail.int (Postfix) with SMTP id 26A8B29082D8
	for &lt;sharron.gross.barron@a.markmail.org&gt;; Tue, 23 Mar 2010 06:59:29 -0700 (PDT)</received><received>(qmail 34182 invoked by uid 500); 23 Mar 2010 13:59:51 -0000</received><mailing-list>contact commits-help@cassandra.apache.org; run by ezmlm</mailing-list><precedence>bulk</precedence><list-help>&lt;mailto:commits-help@cassandra.apache.org&gt;</list-help><list-unsubscribe>&lt;mailto:commits-unsubscribe@cassandra.apache.org&gt;</list-unsubscribe><list-post>&lt;mailto:commits@cassandra.apache.org&gt;</list-post><list-id>&lt;commits.cassandra.apache.org&gt;</list-id><reply-to>dev@cassandra.apache.org</reply-to><delivered-to>mailing list commits@cassandra.apache.org</delivered-to><received>(qmail 34070 invoked by uid 99); 23 Mar 2010 13:59:51 -0000</received><received>from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 Mar 2010 13:59:51 +0000</received><x-asf-spam-status>No, hits=-2000.0 required=10.0
	tests=ALL_TRUSTED</x-asf-spam-status><x-spam-check-by>apache.org</x-spam-check-by><received>from [140.211.11.140] (HELO brutus.apache.org) (140.211.11.140)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 Mar 2010 13:59:48 +0000</received><received>from brutus.apache.org (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id BBB25234C4A8
	for &lt;commits@cassandra.apache.org&gt;; Tue, 23 Mar 2010 13:59:27 +0000 (UTC)</received><message-id>114590678.434391269352767767.JavaMail.jira@brutus.apache.org</message-id><date>Tue, 23 Mar 2010 13:59:27 +0000 (UTC)</date><mime-version>1.0</mime-version><content-type>text/plain; charset=utf-8</content-type><content-transfer-encoding>7bit</content-transfer-encoding><x-jira-fingerprint>30527f35849b9dde25b450d4833f0394</x-jira-fingerprint><x-virus-checked>Checked by ClamAV on apache.org</x-virus-checked></headers><normalized-references><normalized-message-id>114590678.434391269352767767.JavaMail.jira@brutus.apache.org</normalized-message-id></normalized-references><body type="text/plain; charset=utf-8"><para depth="0">
    [<br/><url>https://issues.apache.org/jira/browse/CASSANDRA-834?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;focusedCommentId=12848713#action_12848713</url><br/>] 

</para><para depth="0">Brandon Williams commented on CASSANDRA-834:
</para><footer type="noise" depth="0">--------------------------------------------

</footer><para depth="0">+1

</para><quote depth="1"><quotepara depth="1">Exception during batch_mutate
</quotepara><quotepara depth="1">-----------------------------

</quotepara><quotepara depth="1">                Key: CASSANDRA-834
                URL: <url>https://issues.apache.org/jira/browse/CASSANDRA-834</url>
            Project: Cassandra
         Issue Type: Bug
         Components: Core
   Affects Versions: 0.6
        Environment: debian lenny amd64 OpenJDK 64-Bit Server VM (build<br/>1.6.0_0-b11, mixed mode)
           Reporter: Brandon Williams
           Assignee: Jonathan Ellis
           Priority: Minor
            Fix For: 0.6

</quotepara><quotepara depth="1">        Attachments: 834-test.patch, 834-v2.txt, 834.patch

</quotepara><quotepara depth="1">If a batch mutation is sent with deletions referring to a SCF but no SC is<br/>specified in the Deletion object, the following traceback is generated:
ERROR 15:28:16,746 Fatal exception in thread<br/>Thread[ROW-MUTATION-STAGE:22,5,main]
java.lang.RuntimeException: java.lang.ClassCastException:<br/>org.apache.cassandra.db.Column cannot be cast to<br/>org.apache.cassandra.db.SuperColumn
        at<br/>org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:34)
        at<br/>java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at<br/>java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:636)
Caused by: java.lang.ClassCastException: org.apache.cassandra.db.Column cannot<br/>be cast to org.apache.cassandra.db.SuperColumn
        at<br/>org.apache.cassandra.db.SuperColumnSerializer.serialize(SuperColumn.java:300)
        at<br/>org.apache.cassandra.db.SuperColumnSerializer.serialize(SuperColumn.java:284)
        at<br/>org.apache.cassandra.db.ColumnFamilySerializer.serializeForSSTable(ColumnFamilySerializer.java:87)
        at<br/>org.apache.cassandra.db.ColumnFamilySerializer.serialize(ColumnFamilySerializer.java:73)
        at<br/>org.apache.cassandra.db.RowMutationSerializer.freezeTheMaps(RowMutation.java:329)
        at<br/>org.apache.cassandra.db.RowMutationSerializer.serialize(RowMutation.java:341)
        at<br/>org.apache.cassandra.db.RowMutationSerializer.serialize(RowMutation.java:314)
        at<br/>org.apache.cassandra.db.RowMutation.getSerializedBuffer(RowMutation.java:270)
        at org.apache.cassandra.db.RowMutation.apply(RowMutation.java:200)
        at<br/>org.apache.cassandra.service.StorageProxy$3.runMayThrow(StorageProxy.java:282)
        at<br/>org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:30)
        ... 3 more
</quotepara></quote><footer type="noise" depth="0">
</footer><footer type="signature" depth="0" hash="12364841950400781264">-- 
This message is automatically generated by JIRA.
-
You can reply to this email to add a comment to the issue online.

</footer></body></message>