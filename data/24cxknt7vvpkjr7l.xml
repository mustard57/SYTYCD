<message message-id="BANLkTimJd3BZA_8hAGKzOLTa1DoHpLMAHA@mail.gmail.com" list="org.apache.camel.users" id="24cxknt7vvpkjr7l" type="users" date="2011-06-11T19:32:57+02:00" year="2011-01-01" year-month="2011-06-01" year-month-day="2011-06-11" thread-id="24cxknt7vvpkjr7l"><headers><envelope-from-line>Sat Jun 11 09:33:44 2011</envelope-from-line><from personal="Claus Ibsen" address="claus.ibsen@gmail.com">Claus Ibsen &lt;claus.ibsen@gmail.com&gt;</from><to personal="users@camel.apache.org" address="users@camel.apache.org">users@camel.apache.org</to><subject normal="Splitter StopOnException doesn't forward the exception on the Exchange">Re: Splitter StopOnException doesn't forward the exception on the Exchange</subject><received>from srv-117c-be06.markmail.marklogic.com ([172.19.8.46])
          by mail-1.a.markmail.int (JAMES SMTP Server 2.3.1) with SMTP ID 437
          for &lt;bert.cannon.pitts@a.markmail.org&gt;;
          Sat, 11 Jun 2011 09:33:44 -0800 (GMT-08:00)</received><received>from mail.apache.org (slb-117n.markmail.marklogic.com [172.19.8.33])
	by mgw-1.public.markmail.int (Postfix) with SMTP id 7A4C829081CA
	for &lt;bert.cannon.pitts@a.markmail.org&gt;; Sat, 11 Jun 2011 10:33:21 -0700 (PDT)</received><received>(qmail 14669 invoked by uid 500); 11 Jun 2011 17:33:44 -0000</received><mailing-list>contact users-help@camel.apache.org; run by ezmlm</mailing-list><precedence>bulk</precedence><list-help>&lt;mailto:users-help@camel.apache.org&gt;</list-help><list-unsubscribe>&lt;mailto:users-unsubscribe@camel.apache.org&gt;</list-unsubscribe><list-post>&lt;mailto:users@camel.apache.org&gt;</list-post><list-id>&lt;users.camel.apache.org&gt;</list-id><reply-to>users@camel.apache.org</reply-to><delivered-to>mailing list users@camel.apache.org</delivered-to><received>(qmail 14661 invoked by uid 99); 11 Jun 2011 17:33:44 -0000</received><received>from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Jun 2011 17:33:44 +0000</received><x-asf-spam-status>No, hits=0.6 required=5.0
	tests=FREEMAIL_FROM,RCVD_IN_DNSWL_LOW,RFC_ABUSE_POST,SPF_PASS,T_TO_NO_BRKTS_FREEMAIL,URI_HEX</x-asf-spam-status><x-spam-check-by>apache.org</x-spam-check-by><received-spf>pass (nike.apache.org: domain of claus.ibsen@gmail.com designates 74.125.83.173 as permitted sender)</received-spf><received>from [74.125.83.173] (HELO mail-pv0-f173.google.com) (74.125.83.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Jun 2011 17:33:38 +0000</received><received>by pvg3 with SMTP id 3so1870890pvg.32
        for &lt;users@camel.apache.org&gt;; Sat, 11 Jun 2011 10:33:17 -0700 (PDT)</received><dkim-signature>v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:in-reply-to:references:from:date
         :message-id:subject:to:content-type:content-transfer-encoding;
        bh=ZbUxIFo8+sKqI9+TwzQw/QGqLPb9MacK7vqZWpGV4Lc=;
        b=H2+NydY0B6g9ZemfbnkGf5LwyCdxg3Z/5Li+Zva04HcEn2XBndocmTMMexDFHt2dwK
         GocN+OZuCA82JjIC4sVzjkc5psdMZCqpeGUUjZoPJ2roxWVng4yBwjzgV/Cqwag886us
         m5Brtn629jeT0GkXcFFKcQca2FN5PvtDGetpo=</dkim-signature><domainkey-signature>a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=JOn8gJBMDJLn9QJE6jC+lwkCQUV2KDVPGbDe49BgUT8tKF98/E3inRMHICweIcqk92
         gUPe2SfhJpHbqst4CSA07VvUscj5pwY/ybdMslqX2a36gwKiBgnStxdVHTIiabOeb4xP
         AJHejFXb7kMrlx2JwOGo0s9cKwOz9He/GyJoQ=</domainkey-signature><received>by 10.68.16.100 with SMTP id f4mr1496514pbd.57.1307813597044; Sat,
 11 Jun 2011 10:33:17 -0700 (PDT)</received><mime-version>1.0</mime-version><received>by 10.68.44.97 with HTTP; Sat, 11 Jun 2011 10:32:57 -0700 (PDT)</received><in-reply-to>&lt;1307547091924-4469882.post@n5.nabble.com&gt;</in-reply-to><references>&lt;1307547091924-4469882.post@n5.nabble.com&gt;</references><date>Sat, 11 Jun 2011 19:32:57 +0200</date><message-id>BANLkTimJd3BZA_8hAGKzOLTa1DoHpLMAHA@mail.gmail.com</message-id><content-type>text/plain; charset=ISO-8859-1</content-type><content-transfer-encoding>quoted-printable</content-transfer-encoding><x-virus-checked>Checked by ClamAV on apache.org</x-virus-checked></headers><normalized-references><normalized-message-id>BANLkTimJd3BZA_8hAGKzOLTa1DoHpLMAHA@mail.gmail.com</normalized-message-id><normalized-in-reply-to>1307547091924-4469882.post@n5.nabble.com</normalized-in-reply-to><normalized-reference>1307547091924-4469882.post@n5.nabble.com</normalized-reference></normalized-references><body type="text/plain; charset=iso-8859-1"><para depth="0">On Wed, Jun 8, 2011 at 5:31 PM, gsilverman
&lt;<email>gsilverman@dispensingsolutionsinc.com</email>&gt; wrote:
</para><quote depth="1"><quotepara depth="1">I have the following route which uses stopOnException to catch exceptions:

</quotepara><quotepara depth="1">&lt;route errorHandlerRef="queryFormularyError"&gt;
&lt;from uri="seda:createRx" /&gt;
           &lt;split strategyRef="aggregatorStrategy"
parallelProcessing="true" stopOnException="true"&gt;
                 &lt;method bean="processSegment" method="split" /&gt;
                 &lt;bean ref="processSegment" method="process" /&gt;
           &lt;/split&gt;
     &lt;to uri="direct:dispense" /&gt;
&lt;/route&gt;

</quotepara><quotepara depth="1">The processSegment bean in the above route can throw the following
exception:

</quotepara><quotepara depth="1">throw new Exception("Product, " + vendorndc + ", is not in formulary")

</quotepara><quotepara depth="1">I want the caught exception to be processed by the errorHandlerRef in the
route element  but when I call
exchange.getProperty(Exchange.EXCEPTION_CAUGHT, Exception.class) in the
error handler, the exception getMessage() method returns null, not the
message in the thrown exception.

</quotepara></quote><para depth="0">Ah okay so there is an Exception. Check what type the exception is.
The caused exception could be wrapped.
So there may be a cause on the exception, and if you drill down it
most likely contain your exception =  new Exception("Product, " +
vendorndc + ", is not in formulary")

</para><quote depth="1"><quotepara depth="1">Here is my error handler:

</quotepara><quotepara depth="1">public class QueryFormularyErrorHandler implements Processor{
     private static final transient Logger LOG =
LoggerFactory.getLogger(QueryFormularyErrorHandler.class);
     public void process(Exchange exchange) throws Exception {
           Exception e = exchange.getProperty(Exchange.EXCEPTION_CAUGHT,
Exception.class);

</quotepara><quotepara depth="1">           LOG.info("Query formulary error: " + e.getMessage());
           exchange.getIn().setBody(e.getMessage());
     }

</quotepara><quotefooter type="noise" depth="1">}

</quotefooter><quotefooter type="list-management" depth="1">--
View this message in context:<br/><url>http://camel.465427.n5.nabble.com/Splitter-StopOnException-doesn-t-forward-the-exception-on-the-Exchange-tp4469882p4469882.html</url>
Sent from the Camel - Users mailing list archive at Nabble.com.

</quotefooter></quote><footer type="signature" depth="0" hash="14027859312367981380">-- 
Claus Ibsen
</footer><para depth="0">-----------------
FuseSource
Email: <email>cibsen@fusesource.com</email>
Web: <url>http://fusesource.com</url>
Twitter: davsclaus, fusenews
Blog: <url>http://davsclaus.blogspot.com/</url>
Author of Camel in Action: <url>http://www.manning.com/ibsen/</url>
</para></body></message>