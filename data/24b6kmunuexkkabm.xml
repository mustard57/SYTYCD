<message message-id="bug-243497-42497@http.bugs.kde.org/" list="org.kde.digikam-devel" id="24b6kmunuexkkabm" type="bugs" date="2010-07-03T15:17:04+02:00" year="2010-01-01" year-month="2010-07-01" year-month-day="2010-07-03" thread-id="24b6kmunuexkkabm"><headers><envelope-from-line>Sat Jul 03 05:23:15 2010</envelope-from-line><from personal="Chris Samuel" address="kde@csamuel.org">Chris Samuel &lt;kde@csamuel.org&gt;</from><to personal="digikam-devel@kde.org" address="digikam-devel@kde.org">digikam-devel@kde.org</to><subject normal="[Digikam-devel] [Bug 243497] New: Digikam does not exit when &quot;quit&quot;, stuck in select">[Digikam-devel] [Bug 243497] New: Digikam does not exit when "quit", stuck in select</subject><received>from srv-117c-be06.markmail.marklogic.com ([172.19.8.46])
          by mail-1.a.markmail.int (JAMES SMTP Server 2.3.1) with SMTP ID 706
          for &lt;alana.foster.fitzgerald@a.markmail.org&gt;;
          Sat, 3 Jul 2010 05:23:15 -0800 (GMT-08:00)</received><received>from ktown.kde.org (slb-117n.markmail.marklogic.com [172.19.8.33])
	by mgw-1.public.markmail.int (Postfix) with SMTP id B807D290819A
	for &lt;alana.foster.fitzgerald@a.markmail.org&gt;; Sat,  3 Jul 2010 06:22:51 -0700 (PDT)</received><received>(qmail 2305 invoked by uid 72); 3 Jul 2010 13:23:12 -0000</received><received>(qmail 2239 invoked from network); 3 Jul 2010 13:23:09 -0000</received><x-spam-checker-version>SpamAssassin 3.2.5 (2008-06-10) on ktown.kde.org</x-spam-checker-version><received>from unknown (HELO immanuel.kde.org) (138.246.255.177)
	by ktown.kde.org with SMTP; 3 Jul 2010 13:23:07 -0000</received><received>by immanuel.kde.org (Postfix, from userid 30)
	id 4159148001; Sat,  3 Jul 2010 15:17:04 +0200 (CEST)</received><x-bugzilla-url>http://bugs.kde.org/ </x-bugzilla-url><x-bugzilla-reason>AssignedTo</x-bugzilla-reason><x-bugzilla-type>newchanged</x-bugzilla-type><x-bugzilla-watch-reason>None</x-bugzilla-watch-reason><x-bugzilla-product>digikam</x-bugzilla-product><x-bugzilla-component>general</x-bugzilla-component><x-bugzilla-keywords/><x-bugzilla-severity>crash</x-bugzilla-severity><x-bugzilla-who>kde@csamuel.org</x-bugzilla-who><x-bugzilla-status>UNCONFIRMED</x-bugzilla-status><x-bugzilla-priority>NOR</x-bugzilla-priority><x-bugzilla-assigned-to>digikam-devel@kde.org</x-bugzilla-assigned-to><x-bugzilla-target-milestone>---</x-bugzilla-target-milestone><x-bugzilla-changed-fields/><message-id>bug-243497-42497@http.bugs.kde.org/</message-id><auto-submitted>auto-generated</auto-submitted><mime-version>1.0</mime-version><date>Sat,  3 Jul 2010 15:17:04 +0200 (CEST)</date><x-beenthere>digikam-devel@kde.org</x-beenthere><x-mailman-version>2.1.9</x-mailman-version><precedence>list</precedence><reply-to>bug-control@bugs.kde.org,
  digiKam developers room - digiKam - Manage your photographs as a professional with the power of open source &lt;digikam-devel@kde.org&gt;</reply-to><list-id>digiKam developers room - digiKam - Manage your photographs as a
	professional with the power of open source &lt;digikam-devel.kde.org&gt;</list-id><list-unsubscribe>&lt;https://mail.kde.org/mailman/listinfo/digikam-devel&gt;,
	&lt;mailto:digikam-devel-request@kde.org?subject=unsubscribe&gt;</list-unsubscribe><list-archive>&lt;http://mail.kde.org/pipermail/digikam-devel&gt;</list-archive><list-post>&lt;mailto:digikam-devel@kde.org&gt;</list-post><list-help>&lt;mailto:digikam-devel-request@kde.org?subject=help&gt;</list-help><list-subscribe>&lt;https://mail.kde.org/mailman/listinfo/digikam-devel&gt;,
	&lt;mailto:digikam-devel-request@kde.org?subject=subscribe&gt;</list-subscribe><content-type>text/plain; charset="us-ascii"</content-type><content-transfer-encoding>7bit</content-transfer-encoding></headers><normalized-references><normalized-message-id>bug-243497-42497@http.bugs.kde.org/</normalized-message-id></normalized-references><body type="text/plain; charset=&quot;us-ascii&quot;"><para depth="0"><url>https://bugs.kde.org/show_bug.cgi?id=243497</url>

</para><para depth="0">           Summary: Digikam does not exit when "quit", stuck in select
           Product: digikam
           Version: 1.3.0
          Platform: Ubuntu Packages
        OS/Version: Linux
            Status: UNCONFIRMED
          Severity: crash
          Priority: NOR
         Component: general
        AssignedTo: <email>digikam-devel@kde.org</email>
        ReportedBy: <email>kde@csamuel.org</email>

</para><para depth="0">Application: digikam (1.3.0)
KDE Platform Version: 4.4.90 (KDE 4.4.90 (KDE 4.5 RC1))
Qt Version: 4.7.0
Operating System: Linux 2.6.32-23-generic x86_64
Distribution: Ubuntu 10.04 LTS

</para><para depth="0">-- Information about the crash:
chris@quad:~$ apt-cache policy digikam
digikam:
  Installed: 2:1.3.0-0ubuntu1~lucid1~ppa2
  Candidate: 2:1.3.0-0ubuntu1~lucid1~ppa2
  Version table:
 *** 2:1.3.0-0ubuntu1~lucid1~ppa2 0
        500 <url>http://ppa.launchpad.net/kubuntu-ppa/beta/ubuntu/</url> lucid/main
Packages
        100 /var/lib/dpkg/status
     2:1.2.0-0ubuntu2 0
        500 <url>http://mirror.linux.org.au/ubuntu/</url> lucid/main Packages
        500 <url>http://mirrors.uwa.edu.au/ubuntu/</url> lucid/main Packages

</para><para depth="0">Digikam 1.3.0 from the Kubuntu 4.5.0 RC1 PPA does not quit properly, it seems
to be stuck in a select() loop and never exits.   Symptom is that when you
login to KDE next time you get N digikams (where N is the number you ran during
the session, I got 5 last time) start up as KDE has spotted them as running on
logout.

</para><para depth="0">Previously I've used strace to see that the process is stuck in a select loop
which is constantly returning EAGAIN.    I'll comment on this report with more
information on that using strace.

</para><para depth="0">- What I was doing when the application crashed:

</para><para depth="0">To generate the backtrace I manually did kill -11 $PID - it is not a real
crash.

</para><para depth="0">I had run it from the command line and after using the File-&gt;Quit option the
interface closed but the prompt did not return on the command line.    Here is
the full output from being run through to it dropping into the crash reporting
assistant due to my sending it SIGSEGV by hand.

</para><para depth="0">chris@quad:~$ digikam
QSqlDatabasePrivate::removeDatabase: connection 'ConnectionTest' is still in
use, all queries will cease to work.
QStringList
Solid::Backends::KUPnP::KUPnPManager::findDeviceByDeviceInterface(Solid::DeviceInterface::Type)
 error:  "org.freedesktop.DBus.Error.ServiceUnknown" 

</para><para depth="0">QStringList
Solid::Backends::KUPnP::KUPnPManager::findDeviceByDeviceInterface(Solid::DeviceInterface::Type)
 error:  "org.freedesktop.DBus.Error.ServiceUnknown" 

</para><para depth="0">QStringList
Solid::Backends::KUPnP::KUPnPManager::findDeviceByDeviceInterface(Solid::DeviceInterface::Type)
 error:  "org.freedesktop.DBus.Error.ServiceUnknown" 

</para><para depth="0">QStringList
Solid::Backends::KUPnP::KUPnPManager::findDeviceByDeviceInterface(Solid::DeviceInterface::Type)
 error:  "org.freedesktop.DBus.Error.ServiceUnknown" 

</para><para depth="0">QStringList
Solid::Backends::KUPnP::KUPnPManager::findDeviceByDeviceInterface(Solid::DeviceInterface::Type)
 error:  "org.freedesktop.DBus.Error.ServiceUnknown" 

</para><para depth="0">QStringList
Solid::Backends::KUPnP::KUPnPManager::findDeviceByDeviceInterface(Solid::DeviceInterface::Type)
 error:  "org.freedesktop.DBus.Error.ServiceUnknown" 

</para><para depth="0">Time elapsed: 24 ms
Model: Time elapsed: 89 ms
TextureColorizer: Time elapsed: 25 ms
Time elapsed: 3 ms
Model: Time elapsed: 22 ms
QStringList
Solid::Backends::KUPnP::KUPnPManager::findDeviceByDeviceInterface(Solid::DeviceInterface::Type)
 error:  "org.freedesktop.DBus.Error.ServiceUnknown" 

</para><para depth="0">QStringList
Solid::Backends::KUPnP::KUPnPManager::findDeviceByDeviceInterface(Solid::DeviceInterface::Type)
 error:  "org.freedesktop.DBus.Error.ServiceUnknown" 

</para><para depth="0">QStringList
Solid::Backends::KUPnP::KUPnPManager::findDeviceByDeviceInterface(Solid::DeviceInterface::Type)
 error:  "org.freedesktop.DBus.Error.ServiceUnknown" 

</para><para depth="0">QInotifyFileSystemWatcherEngine::addPaths: inotify_add_watch failed: No such
file or directory
QFileSystemWatcher: failed to add paths: /home/chris/.config/ibus/bus
Bus::open: Can not get ibus-daemon's address. 
IBusInputContext::createInputContext: no connection to ibus-daemon 
KCrash: Application 'digikam' crashing...
KCrash: Attempting to start /usr/lib/kde4/libexec/drkonqi from kdeinit
sock_file=/home/chris/.kde/socket-quad/kdeinit4__0

</para><para depth="0">[1]+  Stopped                 digikam

</para><para depth="0">The crash can be reproduced every time.

</para><para depth="0">-- Backtrace:
Application: digiKam (digikam), signal: Segmentation fault
[Current thread is 1 (Thread 0x7f1eae6257c0 (LWP 7997))]

</para><para depth="0">Thread 9 (Thread 0x7f1e942dc710 (LWP 8003)):
#0  pthread_cond_wait@@GLIBC_2.3.2 () at
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:162
#1  0x00007f1ea7603d0b in QWaitConditionPrivate::wait (this=&lt;value optimized
out&gt;, mutex=0x345deb8, time=18446744073709551615) at
thread/qwaitcondition_unix.cpp:87
#2  QWaitCondition::wait (this=&lt;value optimized out&gt;, mutex=0x345deb8,
time=18446744073709551615) at thread/qwaitcondition_unix.cpp:159
#3  0x00007f1eab6402bc in Digikam::ParkingThread::run (this=0x345dea0) at
/build/buildd/digikam-1.3.0/libs/threads/threadmanager.cpp:101
#4  0x00007f1ea760314e in QThreadPrivate::start (arg=0x345dea0) at
thread/qthread_unix.cpp:266
#5  0x00007f1ea73719ca in start_thread (arg=&lt;value optimized out&gt;) at
pthread_create.c:300
#6  0x00007f1ea5e1a6cd in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#7  0x0000000000000000 in ?? ()

</para><para depth="0">Thread 8 (Thread 0x7f1e93adb710 (LWP 8004)):
#0  0x00007f1ea5e12fb3 in select () at ../sysdeps/unix/syscall-template.S:82
#1  0x00007f1ea771f06e in qt_safe_select (nfds=22, fdread=0x3644640,
fdwrite=0x36448d8, fdexcept=0x3644b70, orig_timeout=0x0) at
kernel/qcore_unix.cpp:82
#2  0x00007f1ea772439b in QEventDispatcherUNIXPrivate::doSelect
(this=0x3644480, flags=&lt;value optimized out&gt;, timeout=&lt;value optimized out&gt;) at
kernel/qeventdispatcher_unix.cpp:219
#3  0x00007f1ea7724fcb in QEventDispatcherUNIX::processEvents (this=0x346a7e0,
flags=) at kernel/qeventdispatcher_unix.cpp:919
#4  0x00007f1ea76f45b2 in QEventLoop::processEvents (this=&lt;value optimized
out&gt;, flags=) at kernel/qeventloop.cpp:149
#5  0x00007f1ea76f498c in QEventLoop::exec (this=0x7f1e93adad90, flags=) at
kernel/qeventloop.cpp:201
#6  0x00007f1ea76001cd in QThread::exec (this=&lt;value optimized out&gt;) at
thread/qthread.cpp:490
#7  0x00007f1ea760314e in QThreadPrivate::start (arg=0x34e95e0) at
thread/qthread_unix.cpp:266
#8  0x00007f1ea73719ca in start_thread (arg=&lt;value optimized out&gt;) at
pthread_create.c:300
#9  0x00007f1ea5e1a6cd in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#10 0x0000000000000000 in ?? ()

</para><para depth="0">Thread 7 (Thread 0x7f1e932da710 (LWP 8005)):
#0  0x00007f1ea5e12fb3 in select () at ../sysdeps/unix/syscall-template.S:82
#1  0x00007f1ea771f06e in qt_safe_select (nfds=26, fdread=0x2fe4250,
fdwrite=0x2fe44e8, fdexcept=0x2fe4780, orig_timeout=0x0) at
kernel/qcore_unix.cpp:82
#2  0x00007f1ea772439b in QEventDispatcherUNIXPrivate::doSelect
(this=0x2fe4090, flags=&lt;value optimized out&gt;, timeout=&lt;value optimized out&gt;) at
kernel/qeventdispatcher_unix.cpp:219
#3  0x00007f1ea7724fcb in QEventDispatcherUNIX::processEvents (this=0x34eab80,
flags=) at kernel/qeventdispatcher_unix.cpp:919
#4  0x00007f1ea76f45b2 in QEventLoop::processEvents (this=&lt;value optimized
out&gt;, flags=) at kernel/qeventloop.cpp:149
#5  0x00007f1ea76f498c in QEventLoop::exec (this=0x7f1e932d9d90, flags=) at
kernel/qeventloop.cpp:201
#6  0x00007f1ea76001cd in QThread::exec (this=&lt;value optimized out&gt;) at
thread/qthread.cpp:490
#7  0x00007f1ea760314e in QThreadPrivate::start (arg=0x34946c0) at
thread/qthread_unix.cpp:266
#8  0x00007f1ea73719ca in start_thread (arg=&lt;value optimized out&gt;) at
pthread_create.c:300
#9  0x00007f1ea5e1a6cd in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#10 0x0000000000000000 in ?? ()

</para><para depth="0">Thread 6 (Thread 0x7f1e8b507710 (LWP 8006)):
#0  pthread_cond_timedwait@@GLIBC_2.3.2 () at
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_timedwait.S:211
#1  0x00007f1e8ffa4081 in ?? () from /usr/lib/libxine.so.1
#2  0x00007f1ea73719ca in start_thread (arg=&lt;value optimized out&gt;) at
pthread_create.c:300
#3  0x00007f1ea5e1a6cd in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#4  0x0000000000000000 in ?? ()

</para><para depth="0">Thread 5 (Thread 0x7f1e89292710 (LWP 8008)):
#0  0x00007f1ea5e12fb3 in select () at ../sysdeps/unix/syscall-template.S:82
#1  0x00007f1ea771f06e in qt_safe_select (nfds=30, fdread=0x3ed6920,
fdwrite=0x3ed6bb8, fdexcept=0x3ed6e50, orig_timeout=0x0) at
kernel/qcore_unix.cpp:82
#2  0x00007f1ea772439b in QEventDispatcherUNIXPrivate::doSelect
(this=0x3ed6760, flags=&lt;value optimized out&gt;, timeout=&lt;value optimized out&gt;) at
kernel/qeventdispatcher_unix.cpp:219
#3  0x00007f1ea7724fcb in QEventDispatcherUNIX::processEvents (this=0x3ed6740,
flags=) at kernel/qeventdispatcher_unix.cpp:919
#4  0x00007f1ea76f45b2 in QEventLoop::processEvents (this=&lt;value optimized
out&gt;, flags=) at kernel/qeventloop.cpp:149
#5  0x00007f1ea76f498c in QEventLoop::exec (this=0x7f1e89291d30, flags=) at
kernel/qeventloop.cpp:201
#6  0x00007f1ea76001cd in QThread::exec (this=&lt;value optimized out&gt;) at
thread/qthread.cpp:490
#7  0x00007f1e902002b0 in ?? () from
/usr/lib/qt4/plugins/phonon_backend/phonon_xine.so
#8  0x00007f1ea760314e in QThreadPrivate::start (arg=0x3ed60a0) at
thread/qthread_unix.cpp:266
#9  0x00007f1ea73719ca in start_thread (arg=&lt;value optimized out&gt;) at
pthread_create.c:300
#10 0x00007f1ea5e1a6cd in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#11 0x0000000000000000 in ?? ()

</para><para depth="0">Thread 4 (Thread 0x7f1e82145710 (LWP 8021)):
#0  pthread_cond_timedwait@@GLIBC_2.3.2 () at
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_timedwait.S:211
#1  0x00007f1ea7603c72 in QWaitConditionPrivate::wait (this=&lt;value optimized
out&gt;, mutex=0x5079460, time=30000) at thread/qwaitcondition_unix.cpp:85
#2  QWaitCondition::wait (this=&lt;value optimized out&gt;, mutex=0x5079460,
time=30000) at thread/qwaitcondition_unix.cpp:159
#3  0x00007f1ea75f8bd2 in QThreadPoolThread::run (this=0x4bef680) at
concurrent/qthreadpool.cpp:140
#4  0x00007f1ea760314e in QThreadPrivate::start (arg=0x4bef680) at
thread/qthread_unix.cpp:266
#5  0x00007f1ea73719ca in start_thread (arg=&lt;value optimized out&gt;) at
pthread_create.c:300
#6  0x00007f1ea5e1a6cd in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#7  0x0000000000000000 in ?? ()

</para><para depth="0">Thread 3 (Thread 0x7f1e83147710 (LWP 8023)):
#0  0x00007f1ea5e12fb3 in select () at ../sysdeps/unix/syscall-template.S:82
#1  0x00007f1ea771f06e in qt_safe_select (nfds=50, fdread=0x70c4e80,
fdwrite=0x70c5118, fdexcept=0x70c53b0, orig_timeout=0x0) at
kernel/qcore_unix.cpp:82
#2  0x00007f1ea772439b in QEventDispatcherUNIXPrivate::doSelect
(this=0x70c4cc0, flags=&lt;value optimized out&gt;, timeout=&lt;value optimized out&gt;) at
kernel/qeventdispatcher_unix.cpp:219
#3  0x00007f1ea7724fcb in QEventDispatcherUNIX::processEvents (this=0x499f430,
flags=) at kernel/qeventdispatcher_unix.cpp:919
#4  0x00007f1ea76f45b2 in QEventLoop::processEvents (this=&lt;value optimized
out&gt;, flags=) at kernel/qeventloop.cpp:149
#5  0x00007f1ea76f498c in QEventLoop::exec (this=0x7f1e83146d50, flags=) at
kernel/qeventloop.cpp:201
#6  0x00007f1ea76001cd in QThread::exec (this=&lt;value optimized out&gt;) at
thread/qthread.cpp:490
#7  0x00007f1ea76d44d8 in QInotifyFileSystemWatcherEngine::run (this=0x53e9000)
at io/qfilesystemwatcher_inotify.cpp:248
#8  0x00007f1ea760314e in QThreadPrivate::start (arg=0x53e9000) at
thread/qthread_unix.cpp:266
#9  0x00007f1ea73719ca in start_thread (arg=&lt;value optimized out&gt;) at
pthread_create.c:300
#10 0x00007f1ea5e1a6cd in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#11 0x0000000000000000 in ?? ()

</para><para depth="0">Thread 2 (Thread 0x7f1e7fe98710 (LWP 8024)):
#0  pthread_cond_timedwait@@GLIBC_2.3.2 () at
../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_timedwait.S:211
#1  0x00007f1ea7603c72 in QWaitConditionPrivate::wait (this=&lt;value optimized
out&gt;, mutex=0x3550160, time=30000) at thread/qwaitcondition_unix.cpp:85
#2  QWaitCondition::wait (this=&lt;value optimized out&gt;, mutex=0x3550160,
time=30000) at thread/qwaitcondition_unix.cpp:159
#3  0x00007f1ea75f8bd2 in QThreadPoolThread::run (this=0x52d9b70) at
concurrent/qthreadpool.cpp:140
#4  0x00007f1ea760314e in QThreadPrivate::start (arg=0x52d9b70) at
thread/qthread_unix.cpp:266
#5  0x00007f1ea73719ca in start_thread (arg=&lt;value optimized out&gt;) at
pthread_create.c:300
#6  0x00007f1ea5e1a6cd in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#7  0x0000000000000000 in ?? ()

</para><para depth="0">Thread 1 (Thread 0x7f1eae6257c0 (LWP 7997)):
[KCrash Handler]
#6  0x00007f1ea5e12fb3 in select () at ../sysdeps/unix/syscall-template.S:82
#7  0x00007f1ea771f01a in qt_safe_select (nfds=79, fdread=0x2727300,
fdwrite=0x2727598, fdexcept=0x2727830, orig_timeout=0x7fff48be8ca0) at
kernel/qcore_unix.cpp:92
#8  0x00007f1ea772439b in QEventDispatcherUNIXPrivate::doSelect
(this=0x2727140, flags=&lt;value optimized out&gt;, timeout=&lt;value optimized out&gt;) at
kernel/qeventdispatcher_unix.cpp:219
#9  0x00007f1ea7724fcb in QEventDispatcherUNIX::processEvents (this=0x26e5980,
flags=) at kernel/qeventdispatcher_unix.cpp:919
#10 0x00007f1ea83cffaf in QEventDispatcherX11::processEvents (this=&lt;value
optimized out&gt;, flags=) at kernel/qeventdispatcher_x11.cpp:152
#11 0x00007f1ea76f45b2 in QEventLoop::processEvents (this=&lt;value optimized
out&gt;, flags=) at kernel/qeventloop.cpp:149
#12 0x00007f1ea76f498c in QEventLoop::exec (this=0x7fff48be8f60, flags=) at
kernel/qeventloop.cpp:201
#13 0x00007f1ea76f8a3b in QCoreApplication::exec () at
kernel/qcoreapplication.cpp:1009
#14 0x000000000077ba6d in main (argc=&lt;value optimized out&gt;, argv=&lt;value
optimized out&gt;) at /build/buildd/digikam-1.3.0/digikam/main.cpp:195

</para><para depth="0">Possible duplicates by query: bug 228326, bug 223547.

</para><para depth="0">Reported using DrKonqi

</para><footer type="signature" depth="0" hash="15460749630049231923">-- 
Configure bugmail: <url>https://bugs.kde.org/userprefs.cgi?tab=email</url>
------- You are receiving this mail because: -------
You are the assignee for the bug.
</footer><footer type="list-management" depth="0">_______________________________________________
Digikam-devel mailing list
<email>Digikam-devel@kde.org</email>
<url>https://mail.kde.org/mailman/listinfo/digikam-devel</url>
</footer></body></message>