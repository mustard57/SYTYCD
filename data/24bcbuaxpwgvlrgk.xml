<message message-id="22556730.1205494018166.JavaMail.jira@cloud.prod.atl2.jboss.com" list="org.jboss.lists.jbossts-issues" id="24bcbuaxpwgvlrgk" type="bugs" date="2008-03-14T07:27:01" year="2008-01-01" year-month="2008-03-01" year-month-day="2008-03-14" thread-id="4cpc5vu423ullpnl"><headers><envelope-from-line>From jira-events@lists.jboss.org  Fri Mar 14 07:26:58 2008</envelope-from-line><from personal="Jonathan Halliday (JIRA)" address="jira-events@lists.jboss.org">"Jonathan Halliday (JIRA)" &lt;jira-events@lists.jboss.org&gt;</from><subject normal="[jbossts-issues] [JBoss JIRA] Closed: (JBTM-320) jta/jtax cross-package logging broken">[jbossts-issues] [JBoss JIRA] Closed: (JBTM-320) jta/jtax cross-package logging broken</subject><x-spam-checker-version>SpamAssassin 3.2.4 (2008-01-01) on
	spam-1.dev.markmail.int</x-spam-checker-version><x-spam-level/><x-spam-status>No, score=-1.8 required=5.0 tests=BAYES_00,INVALID_DATE,
	MISSING_HEADERS,NO_RECEIVED,NO_RELAYS autolearn=disabled version=3.2.4</x-spam-status><date>Fri Mar 14 07:27:01 2008</date><in-reply-to>&lt;15422659.1199724044271.JavaMail.jira@cloud.prod.atl2.jboss.com&gt;</in-reply-to><message-id>22556730.1205494018166.JavaMail.jira@cloud.prod.atl2.jboss.com</message-id><content-type>text/plain; charset=iso-8859-1</content-type><mime-version>1.0</mime-version></headers><normalized-references><normalized-message-id>22556730.1205494018166.JavaMail.jira@cloud.prod.atl2.jboss.com</normalized-message-id><normalized-in-reply-to>15422659.1199724044271.JavaMail.jira@cloud.prod.atl2.jboss.com</normalized-in-reply-to></normalized-references><body type="text/plain; charset=iso-8859-1"><para depth="0">
[ <url>http://jira.jboss.com/jira/browse/JBTM-320?page=all</url> ]

</para><para depth="0">Jonathan Halliday closed JBTM-320.
</para><footer type="noise" depth="0">----------------------------------

</footer><para depth="0">    Resolution: Done

</para><quote depth="1"><quotepara depth="1">jta/jtax cross-package logging broken
</quotepara><quotepara depth="1">-------------------------------------

</quotepara><quotepara depth="1">                Key: JBTM-320
                URL: <url>http://jira.jboss.com/jira/browse/JBTM-320</url>
            Project: JBoss Transaction Manager
         Issue Type: Bug
     Security Level: Public(Everyone can see) 
         Components: JTS Implementation
   Affects Versions: 4.3.0.BETA2, 4.2.3.SP6
           Reporter: Jonathan Halliday
        Assigned To: Jonathan Halliday
            Fix For: 4.2.3.SP8, 4.3.0.GA

</quotepara><quotepara depth="1">Some classes in jtax i.e. the JTS based JTA implementation, use logging support<br/>from the jta rather than jtax pakage. This is the only instance of cross-package<br/>logging in the codebase.
This is supported by the LoggerSetup helper class, which merges the jtax log<br/>messages properties file into the jta logger using addResourceBundle.
That means that jtax code can call e.g.
  jtaLogger.loggerI18N.warn("com.arjuna.ats.internal.jta.transaction.jts.syncproblem");
and the message key will get resolved correctly.
jtaLogger.logger.* is not internationalized i.e. does not use resource bundles,<br/>so it's fine too.
The problem comes with jtax code's use of e.g.
  jtaLogger.logMesg.getString("com.arjuna.ats.internal.jta.transaction.jts.subordinate.invalidstate")
as is found in many new Exception(...) type statements and elsewhere.
Since this code bypasses the loggerI18N and goes direct to the un-merged message<br/>bundle, it can resolve only jta keys, not jtax ones. Because it's used mostly in<br/>exception handlers, the problem goes unnoticed until something breaks, at which<br/>point you fail to get a useful error message.
</quotepara></quote><footer type="noise" depth="0">
</footer><footer type="signature" depth="0" hash="13680380643405763944">-- 
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators:<br/><url>http://jira.jboss.com/jira/secure/Administrators.jspa</url>
-
For more information on JIRA, see: <url>http://www.atlassian.com/software/jira</url>

</footer></body></message>