<message message-id="1561753619.1230073604280.JavaMail.jira@brutus" list="org.apache.openjpa.dev" id="24bbmycuye5z7wfa" type="bugs" date="2008-12-23T15:06:44-08:00" year="2008-01-01" year-month="2008-12-01" year-month-day="2008-12-23" thread-id="pahlaofharmogudx"><headers><envelope-from-line>Tue Dec 23 15:07:09 2008</envelope-from-line><from personal="Catalina Wei (JIRA)" address="jira@apache.org">"Catalina Wei (JIRA)" &lt;jira@apache.org&gt;</from><to personal="dev@openjpa.apache.org" address="dev@openjpa.apache.org">dev@openjpa.apache.org</to><subject normal="[jira] Commented: (OPENJPA-833) An improved test case for XML column mapping">[jira] Commented: (OPENJPA-833) An improved test case for XML column mapping</subject><received>from srv-117c-be06.markmail.marklogic.com ([172.19.8.46])
          by mail-1.a.markmail.int (JAMES SMTP Server 2.3.1) with SMTP ID 1001
          for &lt;conrad.brown.gaines@a.markmail.org&gt;;
          Tue, 23 Dec 2008 15:07:09 -0800 (GMT-08:00)</received><received>from mail.apache.org (slb-117n.markmail.marklogic.com [172.19.8.33])
	by mgw-1.public.markmail.int (Postfix) with SMTP id 156C62908063
	for &lt;conrad.brown.gaines@a.markmail.org&gt;; Tue, 23 Dec 2008 15:06:46 -0800 (PST)</received><received>(qmail 82819 invoked by uid 500); 23 Dec 2008 23:07:08 -0000</received><mailing-list>contact dev-help@openjpa.apache.org; run by ezmlm</mailing-list><precedence>bulk</precedence><list-help>&lt;mailto:dev-help@openjpa.apache.org&gt;</list-help><list-unsubscribe>&lt;mailto:dev-unsubscribe@openjpa.apache.org&gt;</list-unsubscribe><list-post>&lt;mailto:dev@openjpa.apache.org&gt;</list-post><list-id>&lt;dev.openjpa.apache.org&gt;</list-id><reply-to>dev@openjpa.apache.org</reply-to><delivered-to>mailing list dev@openjpa.apache.org</delivered-to><received>(qmail 82801 invoked by uid 99); 23 Dec 2008 23:07:08 -0000</received><received>from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 Dec 2008 15:07:07 -0800</received><x-asf-spam-status>No, hits=-2000.0 required=10.0
	tests=ALL_TRUSTED</x-asf-spam-status><x-spam-check-by>apache.org</x-spam-check-by><received>from [140.211.11.140] (HELO brutus.apache.org) (140.211.11.140)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 23 Dec 2008 23:07:05 +0000</received><received>from brutus (localhost [127.0.0.1])
	by brutus.apache.org (Postfix) with ESMTP id 45F50234C464
	for &lt;dev@openjpa.apache.org&gt;; Tue, 23 Dec 2008 15:06:44 -0800 (PST)</received><message-id>1561753619.1230073604280.JavaMail.jira@brutus</message-id><date>Tue, 23 Dec 2008 15:06:44 -0800 (PST)</date><in-reply-to>&lt;1963027250.1229633864243.JavaMail.jira@brutus&gt;</in-reply-to><mime-version>1.0</mime-version><content-type>text/plain; charset=utf-8</content-type><content-transfer-encoding>7bit</content-transfer-encoding><x-virus-checked>Checked by ClamAV on apache.org</x-virus-checked></headers><normalized-references><normalized-message-id>1561753619.1230073604280.JavaMail.jira@brutus</normalized-message-id><normalized-in-reply-to>1963027250.1229633864243.JavaMail.jira@brutus</normalized-in-reply-to></normalized-references><body type="text/plain; charset=utf-8"><para depth="0">
    [<br/><url>https://issues.apache.org/jira/browse/OPENJPA-833?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;focusedCommentId=12658990#action_12658990</url><br/>] 

</para><para depth="0">Catalina Wei commented on OPENJPA-833:
</para><para depth="0">--------------------------------------

</para><para depth="0">Milosz,
It is greatly appreciated that you improved the xmlmapping testcase and fix-up<br/>the jaxb dependencies.
I will commit your patch.

</para><para depth="0">Please do file a separate issue for @AllowFailure testcase.
It seems to me a JAXB unmarshal() bug.

</para><para depth="0">Thanks. 

</para><quote depth="1"><quotepara depth="1">An improved test case for XML column mapping
</quotepara><quotepara depth="1">--------------------------------------------

</quotepara><quotepara depth="1">                Key: OPENJPA-833
                URL: <url>https://issues.apache.org/jira/browse/OPENJPA-833</url>
            Project: OpenJPA
         Issue Type: Test
         Components: sql
   Affects Versions: 1.3.0, 2.0.0
           Reporter: Milosz Tylenda
           Priority: Minor
        Attachments: OPENJPA-833.patch, TestXMLCustomerOrder.java,<br/>TestXMLCustomerOrder.postgres

</quotepara><quotepara depth="1">1. The current version of TestXMLCustomerOrder does not use assert methods
  requiring programmer to watch the results on the screen. It also fails to
  correctly determine whether some dictionaries support XML column.
2. The patched version does roughly the same tests but uses asserts methods
  like other JUnit tests.
3. In order to correctly determine XML support, an EnitityManager is created
  so that the DBDictionary executes its connectedConfiguration method. Let me
  know if there is a better method for doing this.
4. I know the original idea with the current version was to catch the generated
  SQL and compare it with one saved in a file. It was not done, only the SQL
  is logged to a file and there are three files in the repository with
  database specific SQL. I abandoned this approach as I find comparing SQL
  strings too vulnerable to subtle changes in other areas of OpenJPA (e.g
  column ordering, alias names). On the other hand I found the generated SQL
  files very helpful to get familiar with how the XML support is done. So, I
  removed the SQL logging but the patch contains a file with some queries
  executed against PostgreSQL. Let me know if this removing of SQL logging or
  adding new file is not desired.
5. I have found out that filling a List property in entity does not work. I
  have annotated the respective test with @AllowFailure. I will file a
  separate issue for this.
6. As in the current version, there are three queries that are expected to
  fail.
7. Since running the test requires an JAXB implementation (not only the JAXB
  API), I have added Sun's JAXB implementation to openjpa-jdbc/pom.xml
  with runtime scope and also to the main pom.xml to specify the version.
  I chose 2.0.5 as I found it the newset from the 2.0 line.
8. Since XML column mapping requires a newer PostgreSQL JDBC driver I have
  upgraded the version in openjpa-jdbc/pom.xml and
  openjpa-persistence-jdbc/pom.xml.
9. I welcome comments and suggestions.
</quotepara></quote><footer type="noise" depth="0">
</footer><footer type="signature" depth="0" hash="12364841950400781264">-- 
This message is automatically generated by JIRA.
-
You can reply to this email to add a comment to the issue online.

</footer></body></message>