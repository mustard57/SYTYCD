<message message-id="20080827144800.5f9fc5b4@extreme" list="org.kernel.vger.netdev" id="24bwnwugjqpr4mwd" type="development" date="2008-08-27T14:48:00-07:00" year="2008-01-01" year-month="2008-08-01" year-month-day="2008-08-27" thread-id="nufnleiukmhisa6m"><headers><envelope-from-line>Wed Aug 27 14:48:08 2008</envelope-from-line><from personal="Stephen Hemminger" address="shemminger@vyatta.com">Stephen Hemminger &lt;shemminger@vyatta.com&gt;</from><to personal="David Miller" address="davem@davemloft.net">David Miller &lt;davem@davemloft.net&gt;</to><cc personal="andi@firstfloor.org" address="andi@firstfloor.org">andi@firstfloor.org</cc><subject normal="cat /proc/net/tcp takes 0.5 seconds on x86_64">Re: cat /proc/net/tcp takes 0.5 seconds on x86_64</subject><received>from srv-117c-be06.markmail.marklogic.com ([172.19.8.46])
          by mail-1.a.markmail.int (JAMES SMTP Server 2.3.1) with SMTP ID 331
          for &lt;lesa.figueroa.barnes@a.markmail.org&gt;;
          Wed, 27 Aug 2008 14:48:07 -0700 (PDT)</received><received>from vger.kernel.org (slb-117n.markmail.marklogic.com [172.19.8.33])
	by mgw-1.public.markmail.int (Postfix) with ESMTP id ABCE42908063
	for &lt;lesa.figueroa.barnes@a.markmail.org&gt;; Wed, 27 Aug 2008 14:48:07 -0700 (PDT)</received><received>(majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1752794AbYH0VsG (ORCPT
	&lt;rfc822;lesa.figueroa.barnes@a.markmail.org&gt;);
	Wed, 27 Aug 2008 17:48:06 -0400</received><received>(majordomo@vger.kernel.org) by vger.kernel.org id S1752726AbYH0VsE
	(ORCPT &lt;rfc822;netdev-outgoing&gt;); Wed, 27 Aug 2008 17:48:04 -0400</received><received>from mail.vyatta.com ([216.93.170.194]:54283 "EHLO mail.vyatta.com"
	rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S1752546AbYH0VsC (ORCPT &lt;rfc822;netdev@vger.kernel.org&gt;);
	Wed, 27 Aug 2008 17:48:02 -0400</received><received>from localhost (localhost.localdomain [127.0.0.1])
	by mail.vyatta.com (Postfix) with ESMTP id 40E334F4606;
	Wed, 27 Aug 2008 14:48:02 -0700 (PDT)</received><x-virus-scanned>amavisd-new at </x-virus-scanned><x-spam-flag>NO</x-spam-flag><x-spam-score>-1.898</x-spam-score><x-spam-level/><x-spam-status>No, score=-1.898 tagged_above=-10 required=3 tests=[AWL=-1.182,
	BAYES_00=-2.599, FH_HOST_EQ_VERIZON_P=0.001, RCVD_IN_PBL=0.905,
	RCVD_IN_SORBS_DUL=0.877, RDNS_DYNAMIC=0.1]</x-spam-status><received>from mail.vyatta.com ([127.0.0.1])
	by localhost (mail.vyatta.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 7RQvm8HB7yNC; Wed, 27 Aug 2008 14:48:01 -0700 (PDT)</received><received>from extreme (pool-71-245-98-107.ptldor.fios.verizon.net [71.245.98.107])
	by mail.vyatta.com (Postfix) with ESMTP id B3BD14F45E9;
	Wed, 27 Aug 2008 14:48:01 -0700 (PDT)</received><date>Wed, 27 Aug 2008 14:48:00 -0700</date><message-id>20080827144800.5f9fc5b4@extreme</message-id><in-reply-to>&lt;20080827.142941.50104491.davem@davemloft.net&gt;</in-reply-to><references>&lt;200808261549.m7QFnVUN032543@bz-web1.app.phx.redhat.com&gt;
	&lt;20080826163719.GA25066@redhat.com&gt;
	&lt;87zlmyr5nz.fsf@basil.nowhere.org&gt;
	&lt;20080827.142941.50104491.davem@davemloft.net&gt;</references><organization>Vyatta</organization><x-mailer>Claws Mail 3.3.1 (GTK+ 2.12.9; x86_64-pc-linux-gnu)</x-mailer><mime-version>1.0</mime-version><content-type>text/plain; charset=US-ASCII</content-type><content-transfer-encoding>7bit</content-transfer-encoding><sender>netdev-owner@vger.kernel.org</sender><precedence>bulk</precedence><list-id>&lt;netdev.vger.kernel.org&gt;</list-id><x-mailing-list>netdev@vger.kernel.org</x-mailing-list></headers><normalized-references><normalized-message-id>20080827144800.5f9fc5b4@extreme</normalized-message-id><normalized-in-reply-to>20080827.142941.50104491.davem@davemloft.net</normalized-in-reply-to><normalized-reference>200808261549.m7QFnVUN032543@bz-web1.app.phx.redhat.com</normalized-reference><normalized-reference>20080826163719.GA25066@redhat.com</normalized-reference><normalized-reference>87zlmyr5nz.fsf@basil.nowhere.org</normalized-reference><normalized-reference>20080827.142941.50104491.davem@davemloft.net</normalized-reference></normalized-references><body type="text/plain; charset=us-ascii"><para depth="0">On Wed, 27 Aug 2008 14:29:41 -0700 (PDT)
David Miller &lt;<email>davem@davemloft.net</email>&gt; wrote:

</para><quote depth="1"><quotepara depth="1">From: Andi Kleen &lt;<email>andi@firstfloor.org</email>&gt;
Date: Wed, 27 Aug 2008 14:41:52 +0200

</quotepara><quote depth="2"><quotepara depth="2">Dave Jones &lt;<email>davej@redhat.com</email>&gt; writes:

</quotepara><quote depth="3"><quotepara depth="3">Just had this bug reported against our development tree..
</quotepara></quote><quotepara depth="2">
SUSE had an old patch for this which unfortunately got rejected 
some time ago for some bogus reason.
</quotepara></quote><quotepara depth="1">
Really, your patch fixes this specific slowdown that got introduced
recently?  I really doubt it Andi, so please don't use this as an
opportunity to toot your own horn, thanks.
</quotepara><quotefooter type="list-management" depth="1">--
To unsubscribe from this list: send the line "unsubscribe netdev" in
the body of a message to <email>majordomo@vger.kernel.org</email>
More majordomo info at  <url>http://vger.kernel.org/majordomo-info.html</url>
</quotefooter></quote><para depth="0">
I do wonder if having large hash table actually helps? When TCP hash
table gets too big, it means every lookup is a cache miss. Assuming
a busy server with 2000 connections and perfect hash. On a 4G mem x86-64
we are doing 512K hash entries which is ridiculous. Something like 64K
entries is more than enough.
</para><footer type="list-management" depth="0">--
To unsubscribe from this list: send the line "unsubscribe netdev" in
the body of a message to <email>majordomo@vger.kernel.org</email>
More majordomo info at  <url>http://vger.kernel.org/majordomo-info.html</url>
</footer></body></message>