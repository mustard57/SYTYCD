<message message-id="20100830141435.28840.qmail@dev.java.net" list="net.java.dev.glassfish-svn.commits" id="24aemgnhokvb4fgt" no-archive="yes" type="checkins" date="2010-08-30T06:14:15.273719-08:00" year="2010-01-01" year-month="2010-08-01" year-month-day="2010-08-30" thread-id="24aemgnhokvb4fgt"><headers><envelope-from-line>Mon Aug 30 06:14:38 2010</envelope-from-line><from personal="srinik76@dev.java.net" address="srinik76@dev.java.net">srinik76@dev.java.net</from><to personal="commits@glassfish-svn.dev.java.net" address="commits@glassfish-svn.dev.java.net">commits@glassfish-svn.dev.java.net</to><subject normal="svn commit: r40276 - trunk/v3/admingui/common/src/main/java/org/glassfish/admingui/common/handlers/InstanceHandler.java">svn commit: r40276 - trunk/v3/admingui/common/src/main/java/org/glassfish/admingui/common/handlers/InstanceHandler.java</subject><received>from srv-117c-be06.markmail.marklogic.com ([172.19.8.46])
          by mail-1.a.markmail.int (JAMES SMTP Server 2.3.1) with SMTP ID 739
          for &lt;nikki.jackson.robbins@a.markmail.org&gt;;
          Mon, 30 Aug 2010 06:14:38 -0800 (GMT-08:00)</received><received>from dev.java.net (slb-117n.markmail.marklogic.com [172.19.8.33])
	by mgw-1.public.markmail.int (Postfix) with SMTP id BCB0C29081D7
	for &lt;nikki.jackson.robbins@a.markmail.org&gt;; Mon, 30 Aug 2010 07:14:14 -0700 (PDT)</received><received>(qmail 28858 invoked by uid 5000); 30 Aug 2010 14:14:36 -0000</received><mailing-list>contact commits-help@glassfish-svn.dev.java.net; run by ezmlm</mailing-list><precedence>bulk</precedence><x-no-archive>yes</x-no-archive><list-help>&lt;mailto:commits-help@glassfish-svn.dev.java.net&gt;</list-help><list-unsubscribe>&lt;mailto:commits-unsubscribe@glassfish-svn.dev.java.net&gt;</list-unsubscribe><list-post>&lt;mailto:commits@glassfish-svn.dev.java.net&gt;</list-post><reply-to>commits@glassfish-svn.dev.java.net</reply-to><delivered-to>mailing list commits@glassfish-svn.dev.java.net</delivered-to><received>(qmail 28842 invoked by uid 5000); 30 Aug 2010 14:14:36 -0000</received><date>30 Aug 2010 14:14:35 -0000</date><message-id>20100830141435.28840.qmail@dev.java.net</message-id><mime-version>1.0</mime-version><content-type>text/plain; charset=UTF-8</content-type></headers><normalized-references><normalized-message-id>20100830141435.28840.qmail@dev.java.net</normalized-message-id></normalized-references><body type="text/plain; charset=utf-8"><para depth="0">Author: srinik76
Date: 2010-08-30 14:14:31+0000
New Revision: 40276

</para><para depth="0">Modified:
   trunk/v3/admingui/common/src/main/java/org/glassfish/admingui/common/handlers/InstanceHandler.java

</para><para depth="0">Log:
Rest conversion changes for JVM Options done to sync up with rest back end<br/>changes

</para><para depth="0">Modified:<br/>trunk/v3/admingui/common/src/main/java/org/glassfish/admingui/common/handlers/InstanceHandler.java
Url:<br/><url>https://glassfish-svn.dev.java.net/source/browse/glassfish-svn/trunk/v3/admingui/common/src/main/java/org/glassfish/admingui/common/handlers/InstanceHandler.java?view=diff&amp;rev=40276&amp;p1=trunk/v3/admingui/common/src/main/java/org/glassfish/admingui/common/handlers/InstanceHandler.java&amp;p2=trunk/v3/admingui/common/src/main/java/org/glassfish/admingui/common/handlers/InstanceHandler.java&amp;r1=40275&amp;r2=40276</url>
==============================================================================
---<br/>trunk/v3/admingui/common/src/main/java/org/glassfish/admingui/common/handlers/InstanceHandler.java<br/>(original)
+++<br/>trunk/v3/admingui/common/src/main/java/org/glassfish/admingui/common/handlers/InstanceHandler.java<br/>2010-08-30 14:14:31+0000
@@ -177,10 +177,9 @@
             Map&lt;String, Object&gt; payload = new HashMap&lt;String, Object&gt;();
             deleteJvmOptions(handlerCtx);
             for (Map&lt;String, String&gt; oneRow : options) {
-                String value = oneRow.get(PROPERTY_VALUE);
-                if (value.startsWith("-XX:"))
-                    value = "\"" + value + "\"";
-                payload.put("id", value);
+                String str = oneRow.get(PROPERTY_VALUE);
+                ArrayList kv = getKeyValuePair(str);
+                payload.put((String)kv.get(0), kv.get(1));
                 addJvmOption(endpoint,payload);
             }
         } catch (Exception ex) {
@@ -189,8 +188,7 @@
     }

</para><para depth="0">     public static void addJvmOption(String endpoint, Map payload) throws<br/>Exception{
-        if (endpoint.contains("/profiler")) {
-            endpoint = endpoint.substring(0, endpoint.indexOf("/profiler")) +<br/>"/jvm-options";
+        if (endpoint.contains("profiler")) {
             payload.put("profiler", "true");
         }
         RestResponse response = RestApiHandlers.post(endpoint, payload);
@@ -205,9 +203,8 @@
         ArrayList list = getJvmOptions(handlerCtx);
         for (Object s: list) {
             String str = (String)s;
-            if (str.startsWith("-XX:"))
-                str = "\"" + str + "\"";
-            payload.put("id", str);
+            ArrayList kv = getKeyValuePair(str);
+            payload.put((String)kv.get(0), kv.get(1));
             if (endpoint.contains("/profiler")) {
                 endpoint = endpoint.substring(0, endpoint.indexOf("/profiler"))<br/>+ "/jvm-options";
                 payload.put("profiler", "true");
@@ -218,6 +215,24 @@
             }
         }
     }
+
+    private static ArrayList getKeyValuePair(String str) {
+        ArrayList list = new ArrayList(2);
+        int index = str.indexOf("=");
+        String key = "";
+        String value = "";
+        if (index != -1) {
+            key = str.substring(0,str.indexOf("="));
+            value = str.substring(str.indexOf("=")+1,str.length());
+        } else {
+            key = str;
+        }
+        if (key.startsWith("-XX:"))
+            key = "\"" + key + "\"";
+        list.add(0, key);
+        list.add(1, value);
+        return list;
+    }

</para><para depth="0">     /**
      *	&lt;p&gt; This handler restart DAS immediately.&lt;/p&gt;

</para><footer type="list-management" depth="0">---------------------------------------------------------------------
To unsubscribe, e-mail: <email>commits-unsubscribe@glassfish-svn.dev.java.net</email>
For additional commands, e-mail: <email>commits-help@glassfish-svn.dev.java.net</email>

</footer></body></message>