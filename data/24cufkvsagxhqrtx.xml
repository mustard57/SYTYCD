<message message-id="4233F99D.8060402@force-elite.com" list="org.apache.apr.dev" id="24cufkvsagxhqrtx" type="development" date="2005-03-13T00:28:13-08:00" year="2005-01-01" year-month="2005-03-01" year-month-day="2005-03-13" thread-id="24cufkvsagxhqrtx"><headers><envelope-from-line>From dev-return-13877-apmail-apr-dev-archive=apr.apache.org@apr.apache.org Sun Mar 13 08:28:20 2005</envelope-from-line><from personal="Paul Querna" address="chip@force-elite.com">Paul Querna &lt;chip@force-elite.com&gt;</from><to personal="dev@apr.apache.org" address="dev@apr.apache.org">dev@apr.apache.org</to><subject normal="Why doesn't DBM register Cleanups?">Why doesn't DBM register Cleanups?</subject><return-path>dev-return-13877-apmail-apr-dev-archive=apr.apache.org@apr.apache.org</return-path><delivered-to>apmail-apr-dev-archive@www.apache.org</delivered-to><received>(qmail 66852 invoked from network); 13 Mar 2005 08:28:20 -0000</received><received>from hermes.apache.org (HELO mail.apache.org) (209.237.227.199)
  by minotaur-2.apache.org with SMTP; 13 Mar 2005 08:28:20 -0000</received><received>(qmail 5214 invoked by uid 500); 13 Mar 2005 08:28:19 -0000</received><delivered-to>apmail-apr-dev-archive@apr.apache.org</delivered-to><received>(qmail 5165 invoked by uid 500); 13 Mar 2005 08:28:18 -0000</received><mailing-list>contact dev-help@apr.apache.org; run by ezmlm</mailing-list><precedence>bulk</precedence><list-post>&lt;mailto:dev@apr.apache.org&gt;</list-post><list-help>&lt;mailto:dev-help@apr.apache.org&gt;</list-help><list-unsubscribe>&lt;mailto:dev-unsubscribe@apr.apache.org&gt;</list-unsubscribe><list-subscribe>&lt;mailto:dev-subscribe@apr.apache.org&gt;</list-subscribe><delivered-to>mailing list dev@apr.apache.org</delivered-to><received>(qmail 5152 invoked by uid 99); 13 Mar 2005 08:28:18 -0000</received><x-asf-spam-status>No, hits=0.0 required=10.0
	tests=</x-asf-spam-status><x-spam-check-by>apache.org</x-spam-check-by><received-spf>pass (hermes.apache.org: local policy)</received-spf><received>from force-elite.com (HELO utopia.in.force-elite.com) (216.255.199.145)
  by apache.org (qpsmtpd/0.28) with ESMTP; Sun, 13 Mar 2005 00:28:17 -0800</received><x-authuser>chip@force-elite.com</x-authuser><received>from [10.0.0.42] (10.0.0.42:51044)
	by utopia.in.force-elite.com with [XMail 1.17 (Linux/Ix86) ESMTP Server]
	id &lt;S9E796&gt; for &lt;dev@apr.apache.org&gt; from &lt;chip@force-elite.com&gt;;
	Sun, 13 Mar 2005 00:28:13 -0800</received><message-id>4233F99D.8060402@force-elite.com</message-id><date>Sun, 13 Mar 2005 00:28:13 -0800</date><user-agent>Mozilla Thunderbird 1.0 (Macintosh/20041206)</user-agent><x-accept-language>en-us, en</x-accept-language><mime-version>1.0</mime-version><x-enigmail-version>0.89.6.0</x-enigmail-version><x-enigmail-supports>pgp-inline, pgp-mime</x-enigmail-supports><content-type>text/plain; charset=UTF-8; format=flowed</content-type><content-transfer-encoding>7bit</content-transfer-encoding><x-virus-checked>Checked</x-virus-checked><x-spam-rating>minotaur-2.apache.org 1.6.2 0/1000/N</x-spam-rating></headers><normalized-references><normalized-message-id>4233F99D.8060402@force-elite.com</normalized-message-id></normalized-references><body type="text/plain; charset=utf-8; format=flowed"><para depth="0">So, I have been hacking on adding features to mod_mbox:
<url>http://tsunami.in.force-elite.com/httpd-dev/</url>

</para><para depth="0">I was expecting when my pool was cleared, that my DBM handler could 
close, and safely save my changes.  However, after beating my head on it 
for far too long, I looked in the DBM source, and found this:

</para><para depth="0">...
     /* ### register a cleanup to close the DBM? */

</para><para depth="0">     return APR_SUCCESS;
...

</para><para depth="0">So, no cleanup was being run, and I understood why my code that expected 
this behavior was not working.  I added my own cleanups, and my code now 
works.  But, does anyone know *why* the DBM functions have never 
registered cleanups?  I can't come up with a good reason.

</para><para depth="0">-Paul

</para></body></message>